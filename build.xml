<?xml version="1.0" encoding="UTF-8"?>

<project name="nation" default="full-suite" basedir=".">

    <!-- GLOBAL VARIABLES -->
    <property name="source" value="app" />
    <!-- END -->

    <!-- AVAILABLE COMMANDS -->
    <target name="full-suite" depends="date, lint, composer" />
    <!-- END -->

    <!-- DATE -->
    <target name="date">
        <echo message="Printing system date ..."/>
        <exec executable="date" />
    </target>
    <!-- END -->

    <target name="lint"
            unless="lint.done"
            description="Perform syntax check of sourcecode files">
        <apply executable="php" taskname="lint">
            <arg value="-l" />

            <fileset dir="${basedir}/src">
                <include name="**/*.php" />
                <modified />
            </fileset>

            <fileset dir="${basedir}/tests">
                <include name="**/*.php" />
                <modified />
            </fileset>
        </apply>

        <property name="lint.done" value="true"/>
    </target>

    <!-- COMPOSER -->
    <target name="composer">
        <echo message="Running composer self-update ..." />
        <exec executable="/var/lib/jenkins/composer">
            <arg value="self-update" />
        </exec>
        <echo message="Running composer install ..." />
        <exec executable="/var/lib/jenkins/composer" failonerror="true">
            <arg value="install" />
            <arg value="--no-interaction" />
        </exec>
    </target>
    <!-- END -->



</project>